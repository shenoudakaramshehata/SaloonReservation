@page
@model SaloonReservation.Areas.Admin.Pages.Configurations.ManageServices.IndexModel
@Html.AntiForgeryToken()
@inject Microsoft.AspNetCore.Antiforgery.IAntiforgery Xsrf
    @{
    ViewBag.Title = sharedResource["Services"];
    ViewBag.pTitle = sharedResource["Services"];
    ViewBag.pageTitle = sharedResource["Services"];
}


@section styles{
        <!--datatable css-->
        <link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/dataTables.bootstrap5.min.css" />
        <!--datatable responsive css-->
        <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.2.9/css/responsive.bootstrap.min.css" />

        <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.2.2/css/buttons.dataTables.min.css">
}

<div class="row">
    <div class="col-lg-12">
        <div class="card" id="List">
            <div class="card-header border-0">
                <input type="text" asp-for="@Model.url" value="@Model.url" hidden id="UrlId" />

            </div>
            <div class="card-body">
                <table id="ajax-datatables" class="display table table-bordered dt-responsive" style="width:100%">
                    <thead>
                        <tr>

                            <th hidden>ServiceId</th>
                            <th>@sharedResource["Title Ar"]</th>
                            <th>@sharedResource["Title En"]</th>
                            <th>@sharedResource["Duration"]</th>
                            <th>@sharedResource["Actions"]</th>
                        </tr>
                    </thead>

                </table>
            </div>

            <!--end modal-->
        </div>
    </div>
    <!--end col-->
</div>

<partial name="_EditPopup" model="@Model.Service" view-data="ViewData" />
<partial name="_ViewPopup" model="@Model.Service" view-data="ViewData" />
<partial name="_DatchDelete" model="@Model.Service" view-data="ViewData" />


@section scripts{
            <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

        <!--datatable js-->
        <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
        <script src="https://cdn.datatables.net/1.11.5/js/dataTables.bootstrap5.min.js"></script>
        <script src="https://cdn.datatables.net/responsive/2.2.9/js/dataTables.responsive.min.js"></script>
        <script src="https://cdn.datatables.net/buttons/2.2.2/js/dataTables.buttons.min.js"></script>
        <script src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.print.min.js"></script>
        <script src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.html5.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>

@*        <script src="~/assets/js/pages/datatables.init.js"></script>
*@
        <!-- App js -->
        <script src="~/assets/js/app.js"></script>
}
<script>
    /*
    Template Name: Velzon - Admin & Dashboard Template
    Author: Themesbrand
    Website: https://Themesbrand.com/
    Contact: Themesbrand@gmail.com
    File: datatables init js
    */

    document.addEventListener('DOMContentLoaded', function () {
        let table = new DataTable('#example',);
    });


    document.addEventListener('DOMContentLoaded', function () {
        let table = new DataTable('#scroll-vertical', {
            "scrollY": "210px",
            "scrollCollapse": true,
            "paging": false
        });

    });

    document.addEventListener('DOMContentLoaded', function () {
        let table = new DataTable('#scroll-horizontal', {
            "scrollX": true
        });
    });

    document.addEventListener('DOMContentLoaded', function () {
        let table = new DataTable('#alternative-pagination', {
            "pagingType": "full_numbers"
        });
    });

    $(document).ready(function () {
        var t = $('#add-rows').DataTable();
        var counter = 1;

        $('#addRow').on('click', function () {
            t.row.add([
                counter + '.1',
                counter + '.2',
                counter + '.3',
                counter + '.4',
                counter + '.5',
                counter + '.6',
                counter + '.7',
                counter + '.8',
                counter + '.9',
                counter + '.10',
                counter + '.11',
                counter + '.12'
            ]).draw(false);

            counter++;
        });

        // Automatically add a first row of data
        $('#addRow').click();
    });


    $(document).ready(function () {
        $('#example').DataTable();
    });

    //fixed header
    document.addEventListener('DOMContentLoaded', function () {
        let table = new DataTable('#fixed-header', {
            "fixedHeader": true
        });

    });

    //modal data datables
    document.addEventListener('DOMContentLoaded', function () {
        let table = new DataTable('#model-datatables', {
            responsive: {
                details: {
                    display: $.fn.dataTable.Responsive.display.modal({
                        header: function (row) {
                            var data = row.data();
                            return 'Details for ' + data[0] + ' ' + data[1];
                        }
                    }),
                    renderer: $.fn.dataTable.Responsive.renderer.tableAll({
                        tableClass: 'table'
                    })
                }
            }
        });

    });

    //buttons exmples
    document.addEventListener('DOMContentLoaded', function () {
        let table = new DataTable('#buttons-datatables', {
            dom: 'Bfrtip',
            buttons: [
                'copy', 'csv', 'excel', 'print', 'pdf'
            ]
        });
    });

    //buttons exmples
    document.addEventListener('DOMContentLoaded', function () {
        let table = new DataTable('#ajax-datatables', {
            "ajax": {

                url: "/Admin/Configurations/ManageServices/Index",
                type: 'POST',
                headers: { 'XSRF-TOKEN': $('@Html.AntiForgeryToken()').val() }
            },
            "columnDefs": [
                {
                    "targets": -1,
                    "data": "ServiceId",
                    "render": function (data, type, row, meta) {
                        return '<ul class="list-inline hstack gap-2 mb-0"> <li class="list-inline-item" data-bs-toggle="tooltip"data-bs-trigger="hover" data-bs-placement="top"title="View"><a href="javascript:void(0)" data-bs-toggle="modal"><i class="ri-eye-fill align-bottom text-muted" onclick="ShowViewPopUp(' + data + ')" ></i></a></li> <li class="list-inline-item" data-bs-toggle="tooltip"data-bs-trigger="hover" data-bs-placement="top"title="Edit" ><a class="edit-item-btn" href="javascript:void(0)"data-bs-toggle="modal" > <i class="ri-pencil-fill align-bottom text-muted" onclick="editButtonClick(' + data + ')"></i> </a> </li>    <li class="list-inline-item" data-bs-toggle="tooltip" data-bs-trigger="hover" data-bs-placement="top"title="Delete"> <a class="remove-item-btn" data-bs-toggle="modal"href="javascript:void(0)" > <i class="ri-delete-bin-fill align-bottom text-muted" onclick="deleteService(' + data + ')"></i> </a></li></ul>';

                    },
                    "sortable": false
                },
                
                { "name": "ServiceId", "data": "ServiceId", "targets": 0, "visible": false },
                { "name": "serviceTlAr", "data": "serviceTlAr", "targets": 1 },
                { "name": "serviceTlEn", "data": "serviceTlEn", "targets": 2 },
                { "name": "Duration", "data": "Duration", "targets": 3, "visible": true },
               



            ],
        });
    });

    function editButtonClick(ServiceId) {
        $.ajax({
            type: "GET",
            beforeSend: function (xhr) {
                xhr.setRequestHeader("XSRF-TOKEN",
                    $('input:hidden[name="__RequestVerificationToken"]').val());
            }
            ,
            url: "/Admin/Configurations/ManageServices/Index?handler=SingleServiceForEdit",

            data: { "ServiceId": ServiceId },
            contentType: "application/json",
            dataType: "json",
            success: function (response) {
                console.log(response)
                document.getElementById("EServiceHiddenId").value = response.ServiceId
                document.getElementById("ServiceTLARId").value = response.serviceTlAr
                document.getElementById("ServiceTLENId").value = response.serviceTlEn
                document.getElementById("OneKidPriceId").value = response.OneKidPrice
                document.getElementById("MoreKidsPriceId").value = response.MoreKidsPrice
                document.getElementById("DurationId").value = response.Duration
                document.getElementById("GenderId").value = response.GenderId
                $('#showEditModal').modal('show');


            },

            failure: function (response) {
                alert(response);
            }
        });
    }


    function ShowViewPopUp(ServiceId) {

        $.ajax({
            type: "GET",
            url: "/Admin/Configurations/ManageServices/Index?handler=SingleServiceForView",
            data: { "ServiceId": ServiceId },
            contentType: "application/json",
            dataType: "json",
            success: function (response) {
                console.log(response)
                document.getElementById("DDDServiceTLARId").innerHTML = response.serviceTlAr
                document.getElementById("DServiceTLENId").innerHTML = response.serviceTlEn
                document.getElementById("DDescriptionTLARId").innerHTML = response.OneKidPrice
                document.getElementById("DDescriptionTLENId").innerHTML = response.MoreKidsPrice
                document.getElementById("DSortOrderId").innerHTML = response.Duration
                document.getElementById("DIsActiveId").innerHTML = response.Gender.GenderTLEn
               
                $('#QuickViewPoup').modal('show');

            },
            failure: function (response) {
                alert(response);
            }
        });

    }
    function deleteService(ServiceId) {


        $.ajax({
            type: "GET",
            url: "/Admin/Configurations/ManageServices/Index?handler=SingleServiceForDelete",
            data: { "ServiceId": ServiceId },
            contentType: "application/json",
            dataType: "json",
            success: function (response) {
                console.log(response)
                document.getElementById("DDeleteServiceId").value = response.ServiceId
                $('#deleteRecordModal').modal('show');


            },
            failure: function (response) {
                alert(response);
            }
        });
    }

</script>